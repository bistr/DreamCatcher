<html>
  <head>
    <style>
      
@font-face {
    font-family: fontche;
    src: url(opensans.ttf);
}
      

body {
  background-color: #175489;
  font-family: fontche;
  display: flex;
  justify-content: center;
  align-items: center;
  flex-direction:column;
}


.datichka{
  float:right;
  display:block;
  background-color:rgba(0,0,0,0.5);
  padding:10px;
  border-radius:5px 5px 0px 0px;
  width:100%;
  text-align:right;
  margin-right:-10px;
  margin-top:-10px;
  margin-bottom:20px;
    
  
}
li{
  list-style-type:none;
  width:85vw;
  background-color:#4E96D4;
  color:white;
  margin-top:20px;
  padding:10px;
  word-wrap:break-word;
  font-size:1em;
  border-radius:5px;
  box-shadow:2px 2px 5px rgba(0,0,0,0.5);
}
ul{
  margin-left:-35px;
}
      
button{
  border:none;
  color:white;
  background-color:#1E3B54;
  font-size:1.5em;
  border-radius:50px;
  height:30px;
  width:30px;
  padding:0 0 6px 0;

}      
      
    </style>
  </head>
  <body>

  <ul id="dreamlist"></ul>

    
    <script>
      
      
     function delk(){
    if (window.confirm("Are you sure you want to delete this dream?")){
    var dateinquestion=this.parentNode.innerText.split(this.parentNode.innerText[10])[0];
    var dateinq=dateinquestion[6]+dateinquestion[7]+dateinquestion[8]+dateinquestion[9]+"-"+dateinquestion[3]+dateinquestion[4]+"-"+dateinquestion[0]+dateinquestion[1];
    var arrinquestion=JSON.parse(localStorage.getItem(dateinq));
    var indexinq=arrinquestion.indexOf(this.parentNode.innerText.split(this.parentNode.innerText[10])[1].slice(0, -1))

    arrinquestion.splice(indexinq,1);
if (arrinquestion.length==0){
  localStorage.removeItem(dateinq);
}
    else{
    localStorage.setItem(dateinq,JSON.stringify(arrinquestion))
    }
 //alert(this.parentNode.innerText.split(this.parentNode.innerText[10]),)
     
    //alert(n)
    this.parentNode.parentNode.removeChild(this.parentNode);
    }
  }   


  document.getElementById("dreamlist").style.display = "block";
  document.getElementById("dreamlist").innerHTML = "";
    var dreamdate="";
  var dreamcontent="";
  var dreamlist=document.getElementById("dreamlist");
      var butt="<button id='hey'>x</button>"
      var hidemode=localStorage.getItem("hidemode");
  for ( var i = 0, len = localStorage.length; i < len; ++i ) {
    dreamdate=localStorage.key( i ) ;
    for (var dreamid=0; dreamid<JSON.parse(localStorage.getItem(dreamdate)).length;dreamid++){
    
    dreamcontent=JSON.parse(localStorage.getItem(dreamdate))[dreamid] ;
    
if (dreamdate.length==10 && dreamdate[4]==dreamdate[7] && dreamdate[7]=="-"){
  //big edit 
      if (hidemode=="true"){
          var tekst=dreamcontent.split(" ");
    for (var word=0; word<tekst.length;word++){
      var duma=tekst[word];
      if (duma[0].toUpperCase()==duma[0] && duma!="I"){
      var dumareal=""
      var index=0;
        while (duma[index] && duma[index].toLowerCase()!=duma[index].toUpperCase()){
          dumareal+=duma[index]
          index+=1
        }
        if (JSON.parse(localStorage.getItem("namesofpeople")).indexOf(dumareal)!=-1){
          dreamcontent=dreamcontent.replace(dumareal,"*")
        }
     }
   } 
  }
  //end of edit
  
  
  
  
  
  
    var box=document.createElement("li");
    box.innerHTML="<span class='datichka'>"+dreamdate[8]+dreamdate[9]+"."+dreamdate[5]+dreamdate[6]+"."+dreamdate[0]+dreamdate[1] +dreamdate[2]+dreamdate[3]+ "</span><br> " +dreamcontent;
    var t=document.createElement("div");
  t.innerHTML=butt;
  t.addEventListener("click",delk);
box.appendChild(t);
  dreamlist.insertBefore(box, dreamlist.childNodes[0]);
  }}} 
    </script>
  </body>
</html>
